<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Audio To Text</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <script src="https://unpkg.com/heroicons@2.0.18/24/solid/document-duplicate.js"></script>
      <style>
         .gradient-text {
         background-clip: text;
         -webkit-background-clip: text;
         color: transparent;
         background-image: linear-gradient(45deg, #4a90e2, #50e3c2);
         }
         .loader {
         border: 5px solid #f3f3f3;
         border-top: 5px solid #3498db;
         border-radius: 50%;
         width: 50px;
         height: 50px;
         animation: spin 1s linear infinite;
         margin: 20px auto;
         }
         @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
         }
      </style>
   </head>
   <body class="bg-gray-100 min-h-screen flex items-center justify-center">
      <main class="bg-white rounded-lg shadow-md p-8 w-full max-w-2xl">
         <h1 id="audio-to-text" class="text-4xl font-bold mb-6 text-center gradient-text">Audio To Text</h1>
         <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6" role="alert">
            <p class="font-bold">Warning:</p>
            <p>This service is provided for convenience and demonstration purposes. Please be aware of the following risks:</p>
            <ul class="list-disc list-inside">
               <li>Your API key is sent to our server for transcription. While we do not store it, it is transmitted over the internet.</li>
               <li>The audio file you upload is temporarily processed on our server. We do not retain any data, but be cautious about uploading sensitive information.</li>
               <li>The transcription services (OpenAI and AssemblyAI) will process your audio. Review their privacy policies if you have concerns.</li>
               <li>This is a public service. Do not upload confidential or private audio content.</li>
            </ul>
            <p>By using this service, you acknowledge these risks and agree to use it responsibly.</p>
         </div>
         <div class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Step 1: Upload Your Audio File</h2>
            <p>Drop your audio file or click to select one. Supported formats include MP3, WAV, M4A, and more.</p>
            <div id="dropZone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition-colors duration-300">
               Drop your audio file here or click to select
            </div>
         </div>
         <div class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Step 2: Choose a Transcription Service</h2>
            <p>Select the service you prefer. OpenAI is widely used, while AssemblyAI offers higher quality transcriptions.</p>
            <div class="flex justify-center space-x-4">
               <button id="openaiBtn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-300">OpenAI</button>
               <button id="assemblyaiBtn" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition-colors duration-300">AssemblyAI</button>
            </div>
         </div>
         <div id="apiKeySection" class="mb-6 hidden">
            <h2 class="text-xl font-semibold mb-2">Step 3: Enter API Key</h2>
            <p>Provide the API key for your selected service.</p>
            <div id="openaiKeyInput" class="hidden">
               <label for="openaiKey" class="block mb-2">OpenAI API Key:</label>
               <input type="password" id="openaiKey" class="w-full px-3 py-2 border rounded" placeholder="Enter OpenAI API Key">
            </div>
            <div id="assemblyaiKeyInput" class="hidden">
               <label for="assemblyaiKey" class="block mb-2">AssemblyAI API Key:</label>
               <input type="password" id="assemblyaiKey" class="w-full px-3 py-2 border rounded" placeholder="Enter AssemblyAI API Key">
            </div>
         </div>
         <div class="mb-6">
            <h2 class="text-xl font-semibold mb-2">Step 4: Transcribe</h2>
            <p>Once you've completed the above steps, click the button below to start the transcription process.</p>
            <button id="transcribeBtn" class="w-full px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition-colors duration-300">Transcribe</button>
         </div>
         <div id="loading" class="hidden mt-4 text-center">
            <p>Transcribing... Please wait.</p>
            <div class="loader"></div>
         </div>
         <div id="error" class="hidden mt-4 text-red-500"></div>
         <div id="resultContainer" class="mt-4 hidden">
            <h2 class="text-xl font-semibold mb-2">Transcription Result:</h2>
            <div class="flex items-center mb-2">
               <button id="copyBtn" class="p-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors duration-300 mr-2" title="Copy to Clipboard">
                  <heroicon-s-document-duplicate class="w-6 h-6" />
               </button>
               <span id="copyMessage" class="text-green-500 hidden">Copied!</span>
            </div>
            <div id="result" class="text-gray-700 p-4 bg-gray-100 rounded-lg"></div>
         </div>
      </main>
      <script>
         let selectedService = '';
         let audioFile = null;
         
         const dropZone = document.getElementById('dropZone');
         const openaiBtn = document.getElementById('openaiBtn');
         const assemblyaiBtn = document.getElementById('assemblyaiBtn');
         const apiKeySection = document.getElementById('apiKeySection');
         const openaiKeyInput = document.getElementById('openaiKeyInput');
         const assemblyaiKeyInput = document.getElementById('assemblyaiKeyInput');
         const transcribeBtn = document.getElementById('transcribeBtn');
         const loading = document.getElementById('loading');
         const error = document.getElementById('error');
         const result = document.getElementById('result');
         const copyBtn = document.getElementById('copyBtn');
         const copyMessage = document.getElementById('copyMessage');
         const resultContainer = document.getElementById('resultContainer');
         
         dropZone.addEventListener('click', () => {
             const fileInput = document.createElement('input');
             fileInput.type = 'file';
             fileInput.accept = 'audio/*';
             fileInput.onchange = (e) => {
                 audioFile = e.target.files[0];
                 dropZone.textContent = `File selected: ${audioFile.name}`;
             };
             fileInput.click();
         });
         dropZone.addEventListener('dragover', (e) => e.preventDefault());
         dropZone.addEventListener('drop', handleFileDrop);
         
         openaiBtn.addEventListener('click', () => selectService('openai'));
         assemblyaiBtn.addEventListener('click', () => selectService('assemblyai'));
         transcribeBtn.addEventListener('click', transcribe);
         copyBtn.addEventListener('click', copyToClipboard);
         
         function handleFileDrop(e) {
             e.preventDefault();
             audioFile = e.dataTransfer.files[0];
             dropZone.textContent = `File selected: ${audioFile.name}`;
         }
         
         function selectService(service) {
             selectedService = service;
             apiKeySection.classList.remove('hidden');
             openaiKeyInput.classList.toggle('hidden', service !== 'openai');
             assemblyaiKeyInput.classList.toggle('hidden', service !== 'assemblyai');
         }
         
         async function transcribe() {
             if (!audioFile || !selectedService) {
                 showError('Please select an audio file and a transcription service.');
                 return;
             }
         
             const apiKey = selectedService === 'openai' 
                 ? document.getElementById('openaiKey').value 
                 : document.getElementById('assemblyaiKey').value;
         
             if (!apiKey) {
                 showError('Please enter an API key.');
                 return;
             }
         
             showLoading();
         
             const formData = new FormData();
             formData.append('file', audioFile);
             formData.append('service', selectedService);
             formData.append('api_key', apiKey);
         
             try {
                 const response = await fetch('/transcribe', {
                     method: 'POST',
                     body: formData
                 });
         
                 if (!response.ok) {
                     throw new Error(`HTTP error! status: ${response.status}`);
                 }
         
                 const data = await response.json();
                 showResult(data.transcription);
             } catch (e) {
                 showError('Transcription failed: ' + e.message);
             } finally {
                 hideLoading();
             }
         }
         
         function showLoading() {
             loading.classList.remove('hidden');
             error.classList.add('hidden');
             resultContainer.classList.add('hidden');
         }
         
         function hideLoading() {
             loading.classList.add('hidden');
         }
         
         function showError(message) {
             error.textContent = message;
             error.classList.remove('hidden');
         }
         
         function showResult(transcription) {
             result.textContent = transcription;
             resultContainer.classList.remove('hidden');
         }
         
         function copyToClipboard() {
             const textToCopy = result.textContent;
             navigator.clipboard.writeText(textToCopy).then(() => {
                 copyMessage.classList.remove('hidden');
                 setTimeout(() => {
                     copyMessage.classList.add('hidden');
                 }, 2000);
             }).catch(err => {
                 console.error('Failed to copy text: ', err);
             });
         }
      </script>
   </body>
</html>
function hideLoading() {
loading.classList.add('hidden');
}
function showError(message) {
error.textContent = message;
error.classList.remove('hidden');
}
function showResult(transcription) {
result.textContent = transcription;
result.classList.remove('hidden');
}
</script>
</body>
</html>